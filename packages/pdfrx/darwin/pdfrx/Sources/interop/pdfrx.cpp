// PDFium bindings for Darwin (iOS/macOS)
#include <fpdf_doc.h>
#include <fpdf_annot.h>
#include <fpdf_text.h>
#include <fpdf_edit.h>
#include <fpdf_ppo.h>
#include <fpdf_save.h>
#include <fpdf_formfill.h>
#include <fpdf_sysfontinfo.h>

#if defined(__APPLE__)
#define PDFRX_EXPORT __attribute__((visibility("default"))) __attribute__((used))
#else
#define PDFRX_EXPORT
#endif

// This function is used to keep the linker from stripping out the PDFium
// functions that are not directly referenced in this file. This is necessary
// because we are dynamically loading the functions at runtime via DynamicLibrary.
extern "C" PDFRX_EXPORT void const *const * pdfrx_binding()
{
#define KEEP_FUNC(func) reinterpret_cast<const void *>(#func), reinterpret_cast<const void *>(func)

  static void const * const bindings[] = {
      // PDFium functions
      KEEP_FUNC(FPDF_InitLibraryWithConfig),
      KEEP_FUNC(FPDF_InitLibrary),
      KEEP_FUNC(FPDF_DestroyLibrary),
      KEEP_FUNC(FPDF_SetSandBoxPolicy),
      KEEP_FUNC(FPDF_LoadDocument),
      KEEP_FUNC(FPDF_LoadMemDocument),
      KEEP_FUNC(FPDF_LoadMemDocument64),
      KEEP_FUNC(FPDF_LoadCustomDocument),
      KEEP_FUNC(FPDF_GetFileVersion),
      KEEP_FUNC(FPDF_GetLastError),
      KEEP_FUNC(FPDF_DocumentHasValidCrossReferenceTable),
      KEEP_FUNC(FPDF_GetTrailerEnds),
      KEEP_FUNC(FPDF_GetDocPermissions),
      KEEP_FUNC(FPDF_GetDocUserPermissions),
      KEEP_FUNC(FPDF_GetSecurityHandlerRevision),
      KEEP_FUNC(FPDF_GetPageCount),
      KEEP_FUNC(FPDF_LoadPage),
      KEEP_FUNC(FPDF_GetPageWidthF),
      KEEP_FUNC(FPDF_GetPageWidth),
      KEEP_FUNC(FPDF_GetPageHeightF),
      KEEP_FUNC(FPDF_GetPageHeight),
      KEEP_FUNC(FPDF_GetPageBoundingBox),
      KEEP_FUNC(FPDF_GetPageSizeByIndexF),
      KEEP_FUNC(FPDF_GetPageSizeByIndex),
      KEEP_FUNC(FPDF_RenderPageBitmap),
      KEEP_FUNC(FPDF_RenderPageBitmapWithMatrix),
      KEEP_FUNC(FPDF_ClosePage),
      KEEP_FUNC(FPDF_CloseDocument),
      KEEP_FUNC(FPDF_DeviceToPage),
      KEEP_FUNC(FPDF_PageToDevice),
      KEEP_FUNC(FPDFBitmap_Create),
      KEEP_FUNC(FPDFBitmap_CreateEx),
      KEEP_FUNC(FPDFBitmap_GetFormat),
      KEEP_FUNC(FPDFBitmap_FillRect),
      KEEP_FUNC(FPDFBitmap_GetBuffer),
      KEEP_FUNC(FPDFBitmap_GetWidth),
      KEEP_FUNC(FPDFBitmap_GetHeight),
      KEEP_FUNC(FPDFBitmap_GetStride),
      KEEP_FUNC(FPDFBitmap_Destroy),
      KEEP_FUNC(FPDF_VIEWERREF_GetPrintScaling),
      KEEP_FUNC(FPDF_VIEWERREF_GetNumCopies),
      KEEP_FUNC(FPDF_VIEWERREF_GetPrintPageRange),
      KEEP_FUNC(FPDF_VIEWERREF_GetPrintPageRangeCount),
      KEEP_FUNC(FPDF_VIEWERREF_GetPrintPageRangeElement),
      KEEP_FUNC(FPDF_VIEWERREF_GetDuplex),
      KEEP_FUNC(FPDF_VIEWERREF_GetName),
      KEEP_FUNC(FPDF_CountNamedDests),
      KEEP_FUNC(FPDF_GetNamedDestByName),
      KEEP_FUNC(FPDF_GetNamedDest),
      KEEP_FUNC(FPDF_GetXFAPacketCount),
      KEEP_FUNC(FPDF_GetXFAPacketName),
      KEEP_FUNC(FPDF_GetXFAPacketContent),
      KEEP_FUNC(FPDFDOC_InitFormFillEnvironment),
      KEEP_FUNC(FPDFDOC_ExitFormFillEnvironment),
      KEEP_FUNC(FORM_OnAfterLoadPage),
      KEEP_FUNC(FORM_OnBeforeClosePage),
      KEEP_FUNC(FORM_DoDocumentJSAction),
      KEEP_FUNC(FORM_DoDocumentOpenAction),
      KEEP_FUNC(FORM_DoDocumentAAction),
      KEEP_FUNC(FORM_DoPageAAction),
      KEEP_FUNC(FORM_OnMouseMove),
      KEEP_FUNC(FORM_OnMouseWheel),
      KEEP_FUNC(FORM_OnFocus),
      KEEP_FUNC(FORM_OnLButtonDown),
      KEEP_FUNC(FORM_OnRButtonDown),
      KEEP_FUNC(FORM_OnLButtonUp),
      KEEP_FUNC(FORM_OnRButtonUp),
      KEEP_FUNC(FORM_OnLButtonDoubleClick),
      KEEP_FUNC(FORM_OnKeyDown),
      KEEP_FUNC(FORM_OnKeyUp),
      KEEP_FUNC(FORM_OnChar),
      KEEP_FUNC(FORM_GetFocusedText),
      KEEP_FUNC(FORM_GetSelectedText),
      KEEP_FUNC(FORM_ReplaceAndKeepSelection),
      KEEP_FUNC(FORM_ReplaceSelection),
      KEEP_FUNC(FORM_SelectAllText),
      KEEP_FUNC(FORM_CanUndo),
      KEEP_FUNC(FORM_CanRedo),
      KEEP_FUNC(FORM_Undo),
      KEEP_FUNC(FORM_Redo),
      KEEP_FUNC(FORM_ForceToKillFocus),
      KEEP_FUNC(FORM_GetFocusedAnnot),
      KEEP_FUNC(FORM_SetFocusedAnnot),
      KEEP_FUNC(FPDFPage_HasFormFieldAtPoint),
      KEEP_FUNC(FPDFPage_FormFieldZOrderAtPoint),
      KEEP_FUNC(FPDF_SetFormFieldHighlightColor),
      KEEP_FUNC(FPDF_SetFormFieldHighlightAlpha),
      KEEP_FUNC(FPDF_RemoveFormFieldHighlight),
      KEEP_FUNC(FPDF_FFLDraw),
      KEEP_FUNC(FPDF_GetFormType),
      KEEP_FUNC(FORM_SetIndexSelected),
      KEEP_FUNC(FORM_IsIndexSelected),
      KEEP_FUNC(FPDF_LoadXFA),
      KEEP_FUNC(FPDFAnnot_IsSupportedSubtype),
      KEEP_FUNC(FPDFPage_CreateAnnot),
      KEEP_FUNC(FPDFPage_GetAnnotCount),
      KEEP_FUNC(FPDFPage_GetAnnot),
      KEEP_FUNC(FPDFPage_GetAnnotIndex),
      KEEP_FUNC(FPDFPage_CloseAnnot),
      KEEP_FUNC(FPDFPage_RemoveAnnot),
      KEEP_FUNC(FPDFAnnot_GetSubtype),
      KEEP_FUNC(FPDFAnnot_IsObjectSupportedSubtype),
      KEEP_FUNC(FPDFAnnot_UpdateObject),
      KEEP_FUNC(FPDFAnnot_AddInkStroke),
      KEEP_FUNC(FPDFAnnot_RemoveInkList),
      KEEP_FUNC(FPDFAnnot_AppendObject),
      KEEP_FUNC(FPDFAnnot_GetObjectCount),
      KEEP_FUNC(FPDFAnnot_GetObject),
      KEEP_FUNC(FPDFAnnot_RemoveObject),
      KEEP_FUNC(FPDFAnnot_SetColor),
      KEEP_FUNC(FPDFAnnot_GetColor),
      KEEP_FUNC(FPDFAnnot_HasAttachmentPoints),
      KEEP_FUNC(FPDFAnnot_SetAttachmentPoints),
      KEEP_FUNC(FPDFAnnot_AppendAttachmentPoints),
      KEEP_FUNC(FPDFAnnot_CountAttachmentPoints),
      KEEP_FUNC(FPDFAnnot_GetAttachmentPoints),
      KEEP_FUNC(FPDFAnnot_SetRect),
      KEEP_FUNC(FPDFAnnot_GetRect),
      KEEP_FUNC(FPDFAnnot_GetVertices),
      KEEP_FUNC(FPDFAnnot_GetInkListCount),
      KEEP_FUNC(FPDFAnnot_GetInkListPath),
      KEEP_FUNC(FPDFAnnot_GetLine),
      KEEP_FUNC(FPDFAnnot_SetBorder),
      KEEP_FUNC(FPDFAnnot_GetBorder),
      KEEP_FUNC(FPDFAnnot_GetFormAdditionalActionJavaScript),
      KEEP_FUNC(FPDFAnnot_HasKey),
      KEEP_FUNC(FPDFAnnot_GetValueType),
      KEEP_FUNC(FPDFAnnot_SetStringValue),
      KEEP_FUNC(FPDFAnnot_GetStringValue),
      KEEP_FUNC(FPDFAnnot_GetNumberValue),
      KEEP_FUNC(FPDFAnnot_SetAP),
      KEEP_FUNC(FPDFAnnot_GetAP),
      KEEP_FUNC(FPDFAnnot_GetLinkedAnnot),
      KEEP_FUNC(FPDFAnnot_GetFlags),
      KEEP_FUNC(FPDFAnnot_SetFlags),
      KEEP_FUNC(FPDFAnnot_GetFormFieldFlags),
      KEEP_FUNC(FPDFAnnot_SetFormFieldFlags),
      KEEP_FUNC(FPDFAnnot_GetFormFieldAtPoint),
      KEEP_FUNC(FPDFAnnot_GetFormFieldName),
      KEEP_FUNC(FPDFAnnot_GetFormFieldAlternateName),
      KEEP_FUNC(FPDFAnnot_GetFormFieldType),
      KEEP_FUNC(FPDFAnnot_GetFormFieldValue),
      KEEP_FUNC(FPDFAnnot_GetOptionCount),
      KEEP_FUNC(FPDFAnnot_GetOptionLabel),
      KEEP_FUNC(FPDFAnnot_IsOptionSelected),
      KEEP_FUNC(FPDFAnnot_GetFontSize),
      KEEP_FUNC(FPDFAnnot_SetFontColor),
      KEEP_FUNC(FPDFAnnot_GetFontColor),
      KEEP_FUNC(FPDFAnnot_IsChecked),
      KEEP_FUNC(FPDFAnnot_SetFocusableSubtypes),
      KEEP_FUNC(FPDFAnnot_GetFocusableSubtypesCount),
      KEEP_FUNC(FPDFAnnot_GetFocusableSubtypes),
      KEEP_FUNC(FPDFAnnot_GetLink),
      KEEP_FUNC(FPDFAnnot_GetFormControlCount),
      KEEP_FUNC(FPDFAnnot_GetFormControlIndex),
      KEEP_FUNC(FPDFAnnot_GetFormFieldExportValue),
      KEEP_FUNC(FPDFAnnot_SetURI),
      KEEP_FUNC(FPDFAnnot_GetFileAttachment),
      KEEP_FUNC(FPDFAnnot_AddFileAttachment),
      KEEP_FUNC(FPDFText_LoadPage),
      KEEP_FUNC(FPDFText_ClosePage),
      KEEP_FUNC(FPDFText_CountChars),
      KEEP_FUNC(FPDFText_GetUnicode),
      KEEP_FUNC(FPDFText_GetTextObject),
      KEEP_FUNC(FPDFText_IsGenerated),
      KEEP_FUNC(FPDFText_IsHyphen),
      KEEP_FUNC(FPDFText_HasUnicodeMapError),
      KEEP_FUNC(FPDFText_GetFontSize),
      KEEP_FUNC(FPDFText_GetFontInfo),
      KEEP_FUNC(FPDFText_GetFontWeight),
      KEEP_FUNC(FPDFText_GetFillColor),
      KEEP_FUNC(FPDFText_GetStrokeColor),
      KEEP_FUNC(FPDFText_GetCharAngle),
      KEEP_FUNC(FPDFText_GetCharBox),
      KEEP_FUNC(FPDFText_GetLooseCharBox),
      KEEP_FUNC(FPDFText_GetMatrix),
      KEEP_FUNC(FPDFText_GetCharOrigin),
      KEEP_FUNC(FPDFText_GetCharIndexAtPos),
      KEEP_FUNC(FPDFText_GetText),
      KEEP_FUNC(FPDFText_CountRects),
      KEEP_FUNC(FPDFText_GetRect),
      KEEP_FUNC(FPDFText_GetBoundedText),
      KEEP_FUNC(FPDFText_FindStart),
      KEEP_FUNC(FPDFText_FindNext),
      KEEP_FUNC(FPDFText_FindPrev),
      KEEP_FUNC(FPDFText_GetSchResultIndex),
      KEEP_FUNC(FPDFText_GetSchCount),
      KEEP_FUNC(FPDFText_FindClose),
      KEEP_FUNC(FPDFLink_LoadWebLinks),
      KEEP_FUNC(FPDFLink_CountWebLinks),
      KEEP_FUNC(FPDFLink_GetURL),
      KEEP_FUNC(FPDFLink_CountRects),
      KEEP_FUNC(FPDFLink_GetRect),
      KEEP_FUNC(FPDFLink_GetTextRange),
      KEEP_FUNC(FPDFLink_CloseWebLinks),
      KEEP_FUNC(FPDFBookmark_GetFirstChild),
      KEEP_FUNC(FPDFBookmark_GetNextSibling),
      KEEP_FUNC(FPDFBookmark_GetTitle),
      KEEP_FUNC(FPDFBookmark_GetCount),
      KEEP_FUNC(FPDFBookmark_Find),
      KEEP_FUNC(FPDFBookmark_GetDest),
      KEEP_FUNC(FPDFBookmark_GetAction),
      KEEP_FUNC(FPDFAction_GetType),
      KEEP_FUNC(FPDFAction_GetDest),
      KEEP_FUNC(FPDFAction_GetFilePath),
      KEEP_FUNC(FPDFAction_GetURIPath),
      KEEP_FUNC(FPDFDest_GetDestPageIndex),
      KEEP_FUNC(FPDFDest_GetView),
      KEEP_FUNC(FPDFDest_GetLocationInPage),
      KEEP_FUNC(FPDFLink_GetLinkAtPoint),
      KEEP_FUNC(FPDFLink_GetLinkZOrderAtPoint),
      KEEP_FUNC(FPDFLink_GetDest),
      KEEP_FUNC(FPDFLink_GetAction),
      KEEP_FUNC(FPDFLink_Enumerate),
      KEEP_FUNC(FPDFLink_GetAnnot),
      KEEP_FUNC(FPDFLink_GetAnnotRect),
      KEEP_FUNC(FPDFLink_CountQuadPoints),
      KEEP_FUNC(FPDFLink_GetQuadPoints),
      KEEP_FUNC(FPDF_GetPageAAction),
      KEEP_FUNC(FPDF_GetFileIdentifier),
      KEEP_FUNC(FPDF_GetMetaText),
      KEEP_FUNC(FPDF_GetPageLabel),
      KEEP_FUNC(FPDF_CreateNewDocument),
      KEEP_FUNC(FPDFPage_New),
      KEEP_FUNC(FPDFPage_Delete),
      KEEP_FUNC(FPDF_MovePages),
      KEEP_FUNC(FPDFPage_GetRotation),
      KEEP_FUNC(FPDFPage_SetRotation),
      KEEP_FUNC(FPDFPage_InsertObject),
      KEEP_FUNC(FPDFPage_InsertObjectAtIndex),
      KEEP_FUNC(FPDFPage_RemoveObject),
      KEEP_FUNC(FPDFPage_CountObjects),
      KEEP_FUNC(FPDFPage_GetObject),
      KEEP_FUNC(FPDFPage_HasTransparency),
      KEEP_FUNC(FPDFPage_GenerateContent),
      KEEP_FUNC(FPDFPageObj_Destroy),
      KEEP_FUNC(FPDFPageObj_HasTransparency),
      KEEP_FUNC(FPDFPageObj_GetType),
      KEEP_FUNC(FPDFPageObj_GetIsActive),
      KEEP_FUNC(FPDFPageObj_SetIsActive),
      KEEP_FUNC(FPDFPageObj_Transform),
      KEEP_FUNC(FPDFPageObj_TransformF),
      KEEP_FUNC(FPDFPageObj_GetMatrix),
      KEEP_FUNC(FPDFPageObj_SetMatrix),
      KEEP_FUNC(FPDFPage_TransformAnnots),
      KEEP_FUNC(FPDFPageObj_NewImageObj),
      KEEP_FUNC(FPDFPageObj_GetMarkedContentID),
      KEEP_FUNC(FPDFPageObj_CountMarks),
      KEEP_FUNC(FPDFPageObj_GetMark),
      KEEP_FUNC(FPDFPageObj_AddMark),
      KEEP_FUNC(FPDFPageObj_RemoveMark),
      KEEP_FUNC(FPDFPageObjMark_GetName),
      KEEP_FUNC(FPDFPageObjMark_CountParams),
      KEEP_FUNC(FPDFPageObjMark_GetParamKey),
      KEEP_FUNC(FPDFPageObjMark_GetParamValueType),
      KEEP_FUNC(FPDFPageObjMark_GetParamIntValue),
      KEEP_FUNC(FPDFPageObjMark_GetParamStringValue),
      KEEP_FUNC(FPDFPageObjMark_GetParamBlobValue),
      KEEP_FUNC(FPDFPageObjMark_SetIntParam),
      KEEP_FUNC(FPDFPageObjMark_SetStringParam),
      KEEP_FUNC(FPDFPageObjMark_SetBlobParam),
      KEEP_FUNC(FPDFPageObjMark_RemoveParam),
      KEEP_FUNC(FPDFImageObj_LoadJpegFile),
      KEEP_FUNC(FPDFImageObj_LoadJpegFileInline),
      KEEP_FUNC(FPDFImageObj_SetMatrix),
      KEEP_FUNC(FPDFImageObj_SetBitmap),
      KEEP_FUNC(FPDFImageObj_GetBitmap),
      KEEP_FUNC(FPDFImageObj_GetRenderedBitmap),
      KEEP_FUNC(FPDFImageObj_GetImageDataDecoded),
      KEEP_FUNC(FPDFImageObj_GetImageDataRaw),
      KEEP_FUNC(FPDFImageObj_GetImageFilterCount),
      KEEP_FUNC(FPDFImageObj_GetImageFilter),
      KEEP_FUNC(FPDFImageObj_GetImageMetadata),
      KEEP_FUNC(FPDFImageObj_GetImagePixelSize),
      KEEP_FUNC(FPDFImageObj_GetIccProfileDataDecoded),
      KEEP_FUNC(FPDFPageObj_CreateNewPath),
      KEEP_FUNC(FPDFPageObj_CreateNewRect),
      KEEP_FUNC(FPDFPageObj_GetBounds),
      KEEP_FUNC(FPDFPageObj_GetRotatedBounds),
      KEEP_FUNC(FPDFPageObj_SetBlendMode),
      KEEP_FUNC(FPDFPageObj_SetStrokeColor),
      KEEP_FUNC(FPDFPageObj_GetStrokeColor),
      KEEP_FUNC(FPDFPageObj_SetStrokeWidth),
      KEEP_FUNC(FPDFPageObj_GetStrokeWidth),
      KEEP_FUNC(FPDFPageObj_GetLineJoin),
      KEEP_FUNC(FPDFPageObj_SetLineJoin),
      KEEP_FUNC(FPDFPageObj_GetLineCap),
      KEEP_FUNC(FPDFPageObj_SetLineCap),
      KEEP_FUNC(FPDFPageObj_SetFillColor),
      KEEP_FUNC(FPDFPageObj_GetFillColor),
      KEEP_FUNC(FPDFPageObj_GetDashPhase),
      KEEP_FUNC(FPDFPageObj_SetDashPhase),
      KEEP_FUNC(FPDFPageObj_GetDashCount),
      KEEP_FUNC(FPDFPageObj_GetDashArray),
      KEEP_FUNC(FPDFPageObj_SetDashArray),
      KEEP_FUNC(FPDFPath_CountSegments),
      KEEP_FUNC(FPDFPath_GetPathSegment),
      KEEP_FUNC(FPDFPathSegment_GetPoint),
      KEEP_FUNC(FPDFPathSegment_GetType),
      KEEP_FUNC(FPDFPathSegment_GetClose),
      KEEP_FUNC(FPDFPath_MoveTo),
      KEEP_FUNC(FPDFPath_LineTo),
      KEEP_FUNC(FPDFPath_BezierTo),
      KEEP_FUNC(FPDFPath_Close),
      KEEP_FUNC(FPDFPath_SetDrawMode),
      KEEP_FUNC(FPDFPath_GetDrawMode),
      KEEP_FUNC(FPDFPageObj_NewTextObj),
      KEEP_FUNC(FPDFText_SetText),
      KEEP_FUNC(FPDFText_SetCharcodes),
      KEEP_FUNC(FPDFText_LoadFont),
      KEEP_FUNC(FPDFText_LoadStandardFont),
      KEEP_FUNC(FPDFText_LoadCidType2Font),
      KEEP_FUNC(FPDFTextObj_GetFontSize),
      KEEP_FUNC(FPDFFont_Close),
      KEEP_FUNC(FPDFPageObj_CreateTextObj),
      KEEP_FUNC(FPDFTextObj_GetTextRenderMode),
      KEEP_FUNC(FPDFTextObj_SetTextRenderMode),
      KEEP_FUNC(FPDFTextObj_GetText),
      KEEP_FUNC(FPDFTextObj_GetRenderedBitmap),
      KEEP_FUNC(FPDFTextObj_GetFont),
      KEEP_FUNC(FPDFFont_GetBaseFontName),
      KEEP_FUNC(FPDFFont_GetFamilyName),
      KEEP_FUNC(FPDFFont_GetFontData),
      KEEP_FUNC(FPDFFont_GetIsEmbedded),
      KEEP_FUNC(FPDFFont_GetFlags),
      KEEP_FUNC(FPDFFont_GetWeight),
      KEEP_FUNC(FPDFFont_GetItalicAngle),
      KEEP_FUNC(FPDFFont_GetAscent),
      KEEP_FUNC(FPDFFont_GetDescent),
      KEEP_FUNC(FPDFFont_GetGlyphWidth),
      KEEP_FUNC(FPDFFont_GetGlyphPath),
      KEEP_FUNC(FPDFGlyphPath_CountGlyphSegments),
      KEEP_FUNC(FPDFGlyphPath_GetGlyphPathSegment),
      KEEP_FUNC(FPDFFormObj_CountObjects),
      KEEP_FUNC(FPDFFormObj_GetObject),
      KEEP_FUNC(FPDFFormObj_RemoveObject),
      KEEP_FUNC(FPDF_ImportPagesByIndex),
      KEEP_FUNC(FPDF_ImportPages),
      KEEP_FUNC(FPDF_ImportNPagesToOne),
      KEEP_FUNC(FPDF_NewXObjectFromPage),
      KEEP_FUNC(FPDF_CloseXObject),
      KEEP_FUNC(FPDF_NewFormObjectFromXObject),
      KEEP_FUNC(FPDF_CopyViewerPreferences),
      KEEP_FUNC(FPDF_SaveAsCopy),
      KEEP_FUNC(FPDF_SaveWithVersion),
      KEEP_FUNC(FPDF_GetDefaultTTFMap),
      KEEP_FUNC(FPDF_GetDefaultTTFMapCount),
      KEEP_FUNC(FPDF_GetDefaultTTFMapEntry),
      KEEP_FUNC(FPDF_AddInstalledFont),
      KEEP_FUNC(FPDF_SetSystemFontInfo),
      KEEP_FUNC(FPDF_GetDefaultSystemFontInfo),
      KEEP_FUNC(FPDF_FreeDefaultSystemFontInfo),

      nullptr, nullptr  // End marker
  };
  return bindings;
}
